<?xml version="1.0"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product Id="*"
             Name="TileCutter"
             Language="1033"
             Version="0.0.1.0"
             Manufacturer="TileCutter Project"
             UpgradeCode="633C4102-4C0A-4F00-A7C0-133819127019">

        <Package Description="TileCutter Installer"
                 Comments="Comments about the installer"
                 Manufacturer="TileCutter Project" 
                 InstallerVersion="200" 
                 Compressed="yes" />

        <Media Id='1' Cabinet='product.cab' EmbedCab='yes' />

        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder" Name="PFiles">
                <Directory Id="APPLICATIONFOLDER" Name="TileCutter">
                    <Component Id="c_tcp_register" Guid="">
                        <ProgId Id="TileCutter.tcp" Description "TileCutter Project File" Icon="icon_tcp.ico">
                            <Extension Id="tcp" ContentType="application/x-tilecutter-project">
                                <Verb Id="open" Command="Open" TargetFile="f_tilecutter.exe" Argument='"%1"' />
                            </Extension>
                        </ProgId>
                    </Component>
                    <Component Id="c_tilecutter.exe_startmenu" Guid="">
                        <Shortcut Id="sc_tilecutter.exe_startmenu" Directory="ProgramMenuDir" Name="TileCutter" 
                                  WorkingDirectory="APPLICATIONFOLDER" Icon="icon_tilecutter.ico" Advertise="yes" />
                    </Component>
                    <Component Id="c_tilecutter.exe_desktop" Guid="">
                        <Shortcut Id="sc_tilecutter.exe_desktop" Directory="DesktopFolder" Name="TileCutter" 
                                  WorkingDirectory="APPLICATIONFOLDER" Icon="icon_tilecutter.ico" Advertise="yes" />
                    </Component>
                    <Component Id="c_tilecutter.exe" Guid="">
                        <File Id="f_tilecutter.exe" Name="tilecutter.exe" DiskId="1" Source="tilecutter.exe" KeyPath="yes" />
                    </Component>
                    <Component Id="c_w9xpopen.exe" Guid="">
                        <File Id="f_w9xpopen.exe" Name="w9xpopen.exe" DiskId="1" Source="w9xpopen.exe" KeyPath="yes" />
                    </Component>
                    <Component Id="c_test.png" Guid="">
                        <File Id="f_test.png" Name="test.png" DiskId="1" Source="test.png" KeyPath="yes" />
                    </Component>
                    <Component Id="c_python26.dll" Guid="">
                        <File Id="f_python26.dll" Name="python26.dll" DiskId="1" Source="python26.dll" KeyPath="yes" />
                    </Component>
                    <Component Id="c_licence.txt" Guid="">
                        <File Id="f_licence.txt" Name="licence.txt" DiskId="1" Source="licence.txt" KeyPath="yes" />
                    </Component>
                    <Directory Id="dir_languages" Name="languages">
                    </Directory>
                    <Directory Id="dir_python" Name="python">
                    </Directory>
                </Directory>
             </Directory>
        </Directory>

        <Feature id="Complete" Title="TileCutter" Description="The Complete Package" Level="1" AllowAdvertise="no" Absent="disallow" InstallDefault="local">
            <Feature Id="fea_main_program" Title="Main TileCutter Program" Description="Program executable and supporting files" Level="1" AllowAdvertise="no" InstallDefault="local">
                <ComponentRef Id="c_tcp_register" />
                <ComponentRef Id="c_tilecutter.exe" />
                <ComponentRef Id="c_w9xopen.exe" />
                <ComponentRef Id="c_test.png" />
                <ComponentRef Id="c_python26.dll" />
                <ComponentRef Id="c_licence.txt" />
            </Feature>
            <Feature Id="fea_desktop_shortcut" Title="Desktop Shortcut" Description="Place a shortcut to TileCutter on the Desktop" Level="1" AllowAdvertise="no" InstallDefault="local">
                <ComponentRef Id="c_tilecutter.exe_desktop" />
            </Feature>
            <Feature Id="fea_startmenu_group" Title="Create Start Menu Group" Description="Create shortcuts in the Start Menu" Level="1" AllowAdvertise="no" InstallDefault="local">
                <ComponentRef Id="c_tilecutter.exe_startmenu" />
            </Feature>
        </Feature>

        <Property Id="ApplicationFolderName" Value="TileCutter Installation Directory" />
        <Property Id="WixAppFolder" Value="WixPerMachineFolder" />

        <UIRef Id="WixUI_Advanced" />

        <WixVariable Id="WixUILicenseRtf" Value="licence.txt" />

<!--        <WixVariable Id="WixUIBannerBmp" Value="graphics/wixuibanner.bmp" />
        <WixVariable Id="WixUIDialogBmp" Value="graphics/wixuidialog.bmp" />
        <WixVariable Id="WixUIExclamationIco" Value="graphics/wixuiexclamation.ico" />
        <WixVariable Id="WixUIInfoIco" Value="graphics/wixuiinfo.ico" />
        <WixVariable Id="WixUINewIco" Value="graphics/wixuinew.ico" />
        <WixVariable Id="WixUIUpIco" Value="graphics/wixuiup.ico" /> -->

        <Property Id="WIXUI_EXITDIALOGOPTIONALTEXT" Value="Final install completion text" />

        <Icon Id="icon_tilecutter.ico" SourceFile="graphics/tilecutter.ico" />
        <Icon Id="icon_tcp.ico" SourceFile="graphics/tcp.ico" />

    </Product>
</Wix>
